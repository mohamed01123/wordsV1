<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | English Mastery</title>
    <link rel="stylesheet" href="css/style.css"> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: #f5f5f5;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .main-header {
            background-color: #fff;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
        }
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        .logo {
            color: #333;
            font-size: 2rem;
            font-weight: 700;
            text-decoration: none;
        }
        .nav-links {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .nav-links li {
            margin: 0 1rem;
        }
        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        .nav-links a:hover {
            color: #007bff;
        }
        .hero-section {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            padding: 3rem 0;
            margin-bottom: 2rem;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .hero-section h2 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .hero-section p {
            color: #555;
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
        }
        .dashboard-content {
            padding: 2rem 0;
            text-align: center;
        }
        .word-count-container {
            margin-bottom: 2rem;
            background-color: #fff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: inline-block; /* ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± ØªØ¸Ù‡Ø± Ø¨Ø¬Ø§Ù†Ø¨ Ø¨Ø¹Ø¶Ù‡Ø§ */
            margin: 0.5rem; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
            min-width: 200px; /* Ø­Ø¯ Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø¹Ø±Ø¶ */
        }
        .word-count-container h3 {
            color: #333;
            font-size: 1.5rem; /* ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
            margin-top: 0; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ø¹Ù„ÙˆÙŠ */
            margin-bottom: 0.5rem;
        }
        .word-count {
            font-size: 2.5rem; /* ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
            font-weight: 700;
            color: #007bff;
            margin-top: 0.5rem;
        }
        .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            /* justify-content: center; */ /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙˆØ³ÙŠØ· Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø§Ù„ØªÙ…Ø¯Ø¯ */
            align-items: center;
            padding: 2rem 0; /* Ø¥Ø¶Ø§ÙØ© padding */
        }
        .footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 1rem 0;
            width: 100%;
            margin-top: auto;
        }
        .footer p {
            margin: 0;
        }
        .motivational-area {
            background-color: #e3f2fd; /* Ø®Ù„ÙÙŠØ© Ø²Ø±Ù‚Ø§Ø¡ ÙØ§ØªØ­Ø© */
            color: #0d47a1; /* Ù„ÙˆÙ† Ù†Øµ Ø£Ø²Ø±Ù‚ ØºØ§Ù…Ù‚ */
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            max-width: 800px; /* ØªØ­Ø¯ÙŠØ¯ Ø¹Ø±Ø¶ Ø£Ù‚ØµÙ‰ */
            width: 90%; /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø¹Ø±Ø¶ */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .motivational-area h4 {
            margin-top: 0;
            font-size: 1.3rem;
        }
        .motivational-area p {
            font-size: 1.1rem;
            margin-bottom: 0;
        }

         /* --- Progress Bar Styles --- */
        .progress-container {
            width: 80%;
            max-width: 600px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 1rem auto; /* ØªÙˆØ³ÙŠØ· ÙˆØ¥Ø¶Ø§ÙØ© Ù‡Ø§Ù…Ø´ */
            overflow: hidden; /* Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ· */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }

        .progress-bar {
            width: 0%; /* ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØµÙØ± */
            height: 25px;
            background-color: #4caf50; /* Ø£Ø®Ø¶Ø± */
            text-align: center;
            line-height: 25px; /* Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ù†Øµ Ø¹Ù…ÙˆØ¯ÙŠØ§Ù‹ */
            color: white;
            font-weight: bold;
            border-radius: 10px 0 0 10px; /* Ø²ÙˆØ§ÙŠØ§ Ø¯Ø§Ø¦Ø±ÙŠØ© Ù„Ù„Ø´Ø±ÙŠØ· */
            transition: width 0.5s ease-in-out; /* Ø­Ø±ÙƒØ© Ø³Ù„Ø³Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ± */
        }
        /* --- End Progress Bar Styles --- */

    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
             <a href="dashboard.html" class="logo">English Mastery</a>
            <nav>
                <ul class="nav-links">
                    <li><a href="#" id="logoutLink">Logout</a></li> <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="games.html">Games</a></li>
                    <li><a href="review.html">Review</a></li>
                    <li><a href="wordsmanger.html">Add word</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <section class="hero-section">
            <div class="container">
                <h2 id="welcomeMessage">Welcome to Your Dashboard</h2>
                <p>Manage your words, play games, and review your progress here.</p>
            </div>
         </section>

        <div id="motivationalArea" class="motivational-area" style="display: none;">
            <h4>Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙŠÙˆÙ…</h4>
            <p id="motivationalMessageText"></p>
        </div>

         <div class="dashboard-content">
             <div class="word-count-container">
                 <h3>Total Words Added <span role="img" aria-label="muscle">ğŸ’ª</span></h3>
                 <div class="word-count" id="wordCount">0</div>
             </div>
               <div class="word-count-container">
                 <h3>Easy Words <span role="img" aria-label="star">â­</span></h3>
                 <div class="word-count" id="easyWordCount">0</div>
             </div>
             <div class="word-count-container">
                 <h3>Medium Words <span role="img" aria-label="thinking face">ğŸ¤”</span></h3>
                 <div class="word-count" id="mediumWordCount">0</div>
             </div>
              <div class="word-count-container">
                 <h3>Hard Words <span role="img" aria-label="brain">ğŸ§ </span></h3>
                 <div class="word-count" id="hardWordCount">0</div>
             </div>
             <div class="word-count-container">
                 <h3>Words for Review Today <span role="img" aria-label="calendar">ğŸ“…</span></h3>
                 <div class="word-count" id="reviewWordCount">0</div>
                  <div class="progress-container" id="reviewProgressContainer" style="display: none;">
                       <div class="progress-bar" id="reviewProgressBar">0%</div>
                  </div>
             </div>
         </div>

    </main>

    <footer class="main-footer"> <div class="container">
            <p>Designed and developed by Zouka &copy; 2025.</p>
        </div>
    </footer>

    <script type="module">
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy, limit, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

        // --- Firebase Configuration ---
        const firebaseConfig = {
            apiKey: "AIzaSyCsEtjzlSRu-sXsZryxP0Znl0xyf8AU8pQ",
            authDomain: "tekam-3a3d9.firebaseapp.com",
            projectId: "tekam-3a3d9",
            storageBucket: "tekam-3a3d9.appspot.com",
            messagingSenderId: "792257539056",
            appId: "1:792257539056:web:d3cf470b6145e78e3d0b35",
            measurementId: "G-7QT7Z3RMC9"
        };
    

        // --- Initialize Firebase ---
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- DOM Elements ---
        const logoutLink = document.getElementById('logoutLink');
        const wordCountElement = document.getElementById('wordCount');
        const easyWordCountElement = document.getElementById('easyWordCount');
        const mediumWordCountElement = document.getElementById('mediumWordCount');
        const hardWordCountElement = document.getElementById('hardWordCount');
        const reviewWordCountElement = document.getElementById('reviewWordCount');
        const motivationalArea = document.getElementById('motivationalArea');
        const motivationalMessageText = document.getElementById('motivationalMessageText');
        const welcomeMessageElement = document.getElementById('welcomeMessage');
        const reviewProgressContainer = document.getElementById('reviewProgressContainer');
        const reviewProgressBar = document.getElementById('reviewProgressBar');


        // --- Global Variables ---
        let currentUserUID = null;
        const DAILY_REVIEW_COUNT = 10; // Ø¹Ø¯Ø¯ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©

        // --- Authentication State Change ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUserUID = user.uid;
                // --- Get User Profile (Optional: For welcome message) ---
                try {
                    const userProfileRef = doc(db, "users", currentUserUID);
                    const userProfileSnap = await getDoc(userProfileRef);
                    if (userProfileSnap.exists() && userProfileSnap.data().username) {
                        welcomeMessageElement.textContent = `Welcome back, ${userProfileSnap.data().username}!`;
                    } else {
                        welcomeMessageElement.textContent = 'Welcome to Your Dashboard';
                    }
                } catch (error) {
                    console.error("Error fetching user profile:", error);
                    welcomeMessageElement.textContent = 'Welcome to Your Dashboard';
                }
                // --- Load Data ---
                await loadWordDataAndReview();
                displayMotivationalMessage(); // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­ÙÙŠØ²ÙŠØ© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
                updateReviewProgress(); // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©

            } else {
                // No user signed in. Redirect to login.
                window.location.href = 'index.html'; // Ø£Ùˆ login.html
            }
        });

        // --- Load Word Counts and Determine Review Words ---
        async function loadWordDataAndReview() {
            if (!currentUserUID) return;

            const wordsRef = collection(db, "users", currentUserUID, "words");
            const wordsQuery = query(wordsRef); // Query without specific ordering initially

            try {
                const querySnapshot = await getDocs(wordsQuery);
                let allWords = [];
                let easyCount = 0;
                let mediumCount = 0;
                let hardCount = 0;

                querySnapshot.forEach((doc) => {
                    const wordData = { id: doc.id, ...doc.data() };
                     // Initialize score if it doesn't exist
                    if (wordData.score === undefined || wordData.score === null) {
                       wordData.score = 0; // Default score
                    }
                    allWords.push(wordData);

                    // Count difficulties
                    const difficulty = wordData.difficulty || 'medium'; // Default to medium if not set
                    if (difficulty === "easy") {
                        easyCount++;
                    } else if (difficulty === "medium") {
                        mediumCount++;
                    } else if (difficulty === "hard") {
                        hardCount++;
                    }
                });

                // Update Word Counts Display
                wordCountElement.textContent = allWords.length;
                easyWordCountElement.textContent = easyCount;
                mediumWordCountElement.textContent = mediumCount;
                hardWordCountElement.textContent = hardCount;

                // --- Determine Daily Review Words (SRS Logic) ---
                const today = new Date().toISOString().split('T')[0];
                const reviewDate = localStorage.getItem(`reviewDate_${currentUserUID}`);
                let reviewWords = JSON.parse(localStorage.getItem(`reviewWords_${currentUserUID}`)) || [];
                let reviewProgress = JSON.parse(localStorage.getItem(`reviewProgress_${currentUserUID}`)) || {}; // Track progress {wordId: boolean}

                // Check if it's a new day or no review words are set
                if (reviewDate !== today || reviewWords.length === 0) {
                    console.log("Generating new review words for today.");
                    reviewProgress = {}; // Reset progress for the new day

                    // Sort words: Prioritize 'hard', then by lowest 'score'
                    allWords.sort((a, b) => {
                        const difficultyOrder = { 'hard': 0, 'medium': 1, 'easy': 2 };
                        const diffA = difficultyOrder[a.difficulty || 'medium'];
                        const diffB = difficultyOrder[b.difficulty || 'medium'];

                        if (diffA !== diffB) {
                            return diffA - diffB; // Sort by difficulty first (hard comes first)
                        }
                        // If difficulty is the same, sort by score (lowest score first)
                        return (a.score || 0) - (b.score || 0);
                    });

                    // Select the top DAILY_REVIEW_COUNT words
                    reviewWords = allWords.slice(0, DAILY_REVIEW_COUNT);

                    // Initialize progress for the new words
                    reviewWords.forEach(word => {
                        reviewProgress[word.id] = false; // false means not yet reviewed correctly today
                    });


                    // Save to localStorage specific to the user
                    localStorage.setItem(`reviewWords_${currentUserUID}`, JSON.stringify(reviewWords));
                    localStorage.setItem(`reviewDate_${currentUserUID}`, today);
                    localStorage.setItem(`reviewProgress_${currentUserUID}`, JSON.stringify(reviewProgress));

                    console.log("Selected review words:", reviewWords);
                } else {
                    console.log("Using existing review words for today.");
                }

                // Update Review Count Display
                reviewWordCountElement.textContent = reviewWords.length;
                updateReviewProgress(); // Update progress bar based on loaded/generated data


            } catch (error) {
                console.error("Error loading word data: ", error);
                // Display error message to user?
                 wordCountElement.textContent = 'Error';
                 easyWordCountElement.textContent = 'X';
                 mediumWordCountElement.textContent = 'X';
                 hardWordCountElement.textContent = 'X';
                 reviewWordCountElement.textContent = 'X';
            }
        }


         // --- Update Review Progress Bar ---
        function updateReviewProgress() {
             if (!currentUserUID) return;

             const reviewWords = JSON.parse(localStorage.getItem(`reviewWords_${currentUserUID}`)) || [];
             const reviewProgress = JSON.parse(localStorage.getItem(`reviewProgress_${currentUserUID}`)) || {};
             const totalReviewWords = reviewWords.length;

             if (totalReviewWords > 0) {
                 let completedCount = 0;
                 reviewWords.forEach(word => {
                     if (reviewProgress[word.id] === true) { // Check if marked as completed
                         completedCount++;
                     }
                 });

                 const percentage = Math.round((completedCount / totalReviewWords) * 100);
                 reviewProgressBar.style.width = `${percentage}%`;
                 reviewProgressBar.textContent = `${percentage}%`;
                 reviewProgressContainer.style.display = 'block'; // Show the progress bar

                 // Update motivational message based on completion
                 displayMotivationalMessage(completedCount, totalReviewWords);

             } else {
                 reviewProgressContainer.style.display = 'none'; // Hide if no review words
                 displayMotivationalMessage(0, 0); // Show default/no words message
             }
         }

/*// --- Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ© ---
 Â  Â  Â  Â  function displayMotivationalMessage(completed = -1, total = -1) {
 Â  Â  Â  Â  Â  Â  Â const messages = [
 Â  Â  Â  Â  Â  Â  Â  Â  Â "Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø±Ø§Ø¦Ø¹! Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù… Ù‡Ùˆ Ù…ÙØªØ§Ø­ Ø§Ù„Ù†Ø¬Ø§Ø­.",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "ÙƒÙ„ ÙƒÙ„Ù…Ø© ØªØªØ¹Ù„Ù…Ù‡Ø§ ØªÙ‚Ø±Ø¨Ùƒ Ø®Ø·ÙˆØ© Ù†Ø­Ùˆ Ø§Ù„Ø·Ù„Ø§Ù‚Ø©!",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "ØªØ­Ø¯Ù‰ Ù†ÙØ³Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŒ ÙˆØ§Ø´ÙƒØ± Ù†ÙØ³Ùƒ ØºØ¯Ù‹Ø§.",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "Ø§Ù„ØªØ¹Ù„Ù… Ø±Ø­Ù„Ø©ØŒ Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ø¹Ù…Ù„ÙŠØ©!",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "Ø®Ø·ÙˆØ§Øª ØµØºÙŠØ±Ø© ÙƒÙ„ ÙŠÙˆÙ… ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ ÙƒØ¨ÙŠØ±Ø©.",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "Ø«Ù‚ Ø¨Ù†ÙØ³ÙƒØŒ Ø£Ù†Øª Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ Ø°Ù„Ùƒ!",
 Â  Â  Â  Â  Â  Â  Â  Â  Â "Ù„Ø§ ØªØ®Ù Ù…Ù† Ø§Ø±ØªÙƒØ§Ø¨ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ - ÙÙ‡ÙŠ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ØªØ¹Ù„Ù…."
 Â  Â  Â  Â  Â  Â  Â ];

 Â  Â  Â  Â  Â  Â  let message = "";

 Â  Â  Â  Â  Â  Â  if (total > 0) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â if (completed === total) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  message = "ğŸ‰ Ù…Ù…ØªØ§Ø²! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ù…Ø±Ø§Ø¬Ø¹Ø§ØªÙƒ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…! Ø­Ø§Ù† Ø§Ù„ÙˆÙ‚Øª Ù„ØªØ¹Ù„Ù… ÙƒÙ„Ù…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡!";
 Â  Â  Â  Â  Â  Â  Â  Â  Â } else if (completed > 0) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const randomIndex = Math.floor(Math.random() * messages.length);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  message = `Ø£Ù†Øª ØªÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹! ØªÙ… Ø¥Ù†Ø¬Ø§Ø² ${completed} Ù…Ù† ${total} Ù…Ø±Ø§Ø¬Ø¹Ø©. ${messages[randomIndex]}`;

 Â  Â  Â  Â  Â  Â  Â  Â  Â } else {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø¨Ø¹Ø¯
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const randomIndex = Math.floor(Math.random() * messages.length);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  message = `Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ${total} ÙƒÙ„Ù…Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…ØŸ ${messages[randomIndex]}`;
 Â  Â  Â  Â  Â  Â  Â  Â  Â }
 Â  Â  Â  Â  Â  Â  Â } else if (total === 0 && wordCountElement.textContent !== '0' && wordCountElement.textContent !== 'Error') {
 Â  Â  Â  Â  Â  Â  Â  Â  Â // Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ ÙƒÙ„Ù…Ø§Øª Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (Ø±Ø¨Ù…Ø§ Ø£Ù‚Ù„ Ù…Ù† 10 ÙƒÙ„Ù…Ø§Øª Ø¥Ø¬Ù…Ø§Ù„Ø§Ù‹ØŸ)
 Â  Â  Â  Â  Â  Â  Â  Â  Â message = "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø£ÙŠ ÙƒÙ„Ù…Ø§Øª Ù…Ø¬Ø¯ÙˆÙ„Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…. Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø£Ùˆ ØªØ¯Ø±Ø¨ ÙÙŠ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨!";
 Â  Â  Â  Â  Â  Â  } else if (wordCountElement.textContent === '0') {
 Â  Â  Â  Â  Â  Â  Â  Â  Â message = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙØ­Ø© 'Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø©'.";
 Â  Â  Â  Â  Â  Â  Â } else {
 Â  Â  Â  Â  Â  Â  Â  Â  Â // Ø­Ø§Ù„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø£Ùˆ Ø­Ø§Ù„Ø© Ø®Ø·Ø£
 Â  Â  Â  Â  Â  Â  Â  Â  Â const randomIndex = Math.floor(Math.random() * messages.length);
 Â  Â  Â  Â  Â  Â  Â  Â  Â message = messages[randomIndex];
 Â  Â  Â  Â  Â  Â  Â }


 Â  Â  Â  Â  Â  Â  if (message) {
 Â  Â  Â  Â  Â  Â  Â  Â  motivationalMessageText.textContent = message;
 Â  Â  Â  Â  Â  Â  Â  Â  motivationalArea.style.display = 'block';
 Â  Â  Â  Â  Â  Â  } else {
 Â  Â  Â  Â  Â  Â  Â  Â  motivationalArea.style.display = 'none';
 Â  Â  Â  Â  Â  Â  }
 Â  Â  Â  Â  }*/
        // --- Display Motivational Message ---
        function displayMotivationalMessage(completed = -1, total = -1) {
             const messages = [
                 "Keep up the great work! Consistency is key.",
                 "Every word you learn brings you closer to fluency!",
                 "Challenge yourself today, thank yourself tomorrow.",
                 "Learning is a journey, enjoy the process!",
                 "Small steps every day lead to big results.",
                 "Believe in yourself, you've got this!",
                 "Don't be afraid to make mistakes â€“ they are part of learning."
             ];

            let message = "";

            if (total > 0) {
                 if (completed === total) {
                      message = "ğŸ‰ Fantastic! You've completed all your reviews for today! Time to learn new words or relax!";
                 } else if (completed > 0) {
                      const randomIndex = Math.floor(Math.random() * messages.length);
                      message = `You're doing great! ${completed} out of ${total} reviews done. ${messages[randomIndex]}`;
                      
                 } else {
                      // User hasn't started reviews yet
                      const randomIndex = Math.floor(Math.random() * messages.length);
                      message = `Ready to tackle your ${total} review words for today? ${messages[randomIndex]}`;
                 }
             } else if (total === 0 && wordCountElement.textContent !== '0' && wordCountElement.textContent !== 'Error') {
                 // No words selected for review (maybe less than 10 words total?)
                 message = "You don't have any words scheduled for review today. Add more words or practice in the games!";
            } else if (wordCountElement.textContent === '0') {
                 message = "Welcome! Start by adding some words using the 'Add word' page.";
             } else {
                 // Default or error state
                 const randomIndex = Math.floor(Math.random() * messages.length);
                 message = messages[randomIndex];
             }


            if (message) {
                motivationalMessageText.textContent = message;
                motivationalArea.style.display = 'block';
            } else {
                motivationalArea.style.display = 'none';
            }
        }

        // --- Logout Functionality ---
        logoutLink.addEventListener('click', (event) => {
            event.preventDefault(); // Prevent default link behavior
            signOut(auth)
                .then(() => {
                    // Clear user-specific localStorage on logout
                    localStorage.removeItem(`reviewWords_${currentUserUID}`);
                    localStorage.removeItem(`reviewDate_${currentUserUID}`);
                    localStorage.removeItem(`reviewProgress_${currentUserUID}`);
                    // Optional: Clear general items if needed, but be careful not to affect other users if the app is multi-user on one browser
                    // localStorage.removeItem('loggedIn'); // If you use this
                    console.log('User signed out successfully');
                    window.location.href = 'index.html'; // Redirect to login/home page
                })
                .catch((error) => {
                    console.error('Logout error:', error);
                    // Inform user about the error?
                    alert('Logout failed. Please try again.');
                });
        });

    </script>

</body>
</html>